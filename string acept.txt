#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char input[100];
int i = 0, valid = 1;

void E();
void E_dash();
void T();
void T_dash();
void F();
void match(char expected_char);

void match(char expected_char) {
    if (input[i] == expected_char) {
        i++;
    } else {
        valid = 0;
    }
}

void E() {
    T();
    E_dash();
}

void E_dash() {
    if (input[i] == '+') {
        i++;
        T();
        E_dash();
    }
    // ε (do nothing if no '+')
}

void T() {
    F();
    T_dash();
}

void T_dash() {
    if (input[i] == '*') {
        i++;
        F();
        T_dash();
    }
    // ε (do nothing if no '*')
}

void F() {
    if (input[i] == '(') {
        i++;
        E();
        match(')');
    } 
    else if (input[i] == 'i' && input[i+1] == 'd') {
        i += 2; // consume "id"
    } 
    else {
        valid = 0;
    }
}

int main() {
    printf("Enter input string: ");
    scanf("%s", input);

    E();

    if (valid == 1 && i == strlen(input)) {
        printf(" Accepted.\n");
    } else {
        printf(" Rejected.\n");
    }

    return 0;
}
