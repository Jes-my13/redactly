#include <stdio.h>
#include <string.h>

char exprsn[50];
char temp_var = 'Z';  // Temporary variable starting from Z

int main()
{
    printf("Enter the expression: ");
    scanf("%s", exprsn);

    printf("\nIntermediate code:\n");

    // Loop until the expression is reduced to a single assignment (e.g., a+b -> T=a+b)
    while (strlen(exprsn) > 3)
    {
        int flag = 0;

        // First handle higher precedence: / and *
        for (int i = 0; i < strlen(exprsn); i++)
        {
            if (exprsn[i] == '/' || exprsn[i] == '*')
            {
                printf("%c=%c%c%c\n", temp_var, exprsn[i - 1], exprsn[i], exprsn[i + 1]);
                exprsn[i - 1] = temp_var;  // Replace left operand with temp var
                temp_var--; // Go to next temp variable

                // Shift remaining part of expression left by 2 to remove operator and right operand
                for (int j = i; exprsn[j] != '\0'; j++)
                {
                    exprsn[j] = exprsn[j + 2];
                }
                flag = 1;
                break;
            }
        }

        // Then handle + and -
        if (flag != 1)
        {
            for (int i = 0; i < strlen(exprsn); i++)
            {
                if (exprsn[i] == '+' || exprsn[i] == '-')
                {
                    printf("%c=%c%c%c\n", temp_var, exprsn[i - 1], exprsn[i], exprsn[i + 1]);
                    exprsn[i - 1] = temp_var;
                    temp_var--;

                    for (int j = i; exprsn[j] != '\0'; j++)
                    {
                        exprsn[j] = exprsn[j + 2];
                    }
                    flag = 1;
                    break;
                }
            }
        }
    }

    // Final assignment after reducing everything
    printf("%c=%c%c%c\n", temp_var, exprsn[0], exprsn[1], exprsn[2]);

    return 0;
}
